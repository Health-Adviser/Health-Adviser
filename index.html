<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <!-- ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡∏ô‡∏µ‡πâ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡πÅ‡∏•‡πâ‡∏ß: ‡∏™‡∏±‡πà‡∏á‡πÉ‡∏´‡πâ‡πÄ‡∏ö‡∏£‡∏≤‡∏ß‡πå‡πÄ‡∏ã‡∏≠‡∏£‡πå‡πÉ‡∏ä‡πâ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Å‡∏ß‡πâ‡∏≤‡∏á‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏à‡∏£‡∏¥‡∏á -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Health Score | ‡∏ó‡∏µ‡πà‡∏õ‡∏£‡∏∂‡∏Å‡∏©‡∏≤‡∏î‡πâ‡∏≤‡∏ô‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û‡∏î‡πâ‡∏ß‡∏¢‡πÄ‡∏ó‡∏Ñ‡πÇ‡∏ô‡πÇ‡∏•‡∏¢‡∏µ AI</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* --- GLOBAL & FONT --- */
        body { font-family: 'Inter', sans-serif; transition: background-color 0.5s ease; }
        
        /* --- LANDING PAGE STYLES (DARK MODE) --- */
        .landing-bg {
            background-color: #0d1117; /* Very dark background */
            color: #e5e7eb;
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .cta-button {
            background-image: linear-gradient(to right, #10b981, #06b6d4); /* Emerald to Cyan */
            box-shadow: 0 10px 20px -5px rgba(16, 185, 129, 0.5);
            transition: all 0.3s ease;
        }
        .cta-button:hover {
            box-shadow: 0 15px 30px -8px rgba(6, 182, 212, 0.7);
            transform: scale(1.05);
        }
        .main-text-gradient {
            background-image: linear-gradient(to right, #6366f1, #06b6d4);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        /* --- ANALYSIS PAGE STYLES (LIGHT MODE) --- */
        .analysis-bg {
            /* ‡∏•‡∏ö padding: 2rem; ‡∏≠‡∏≠‡∏Å ‡πÅ‡∏•‡∏∞‡πÉ‡∏ä‡πâ Tailwind classes ‡πÅ‡∏ó‡∏ô‡∏ó‡∏µ‡πà #analysis-page */
            background-color: #f0fdfa; /* Light Teal Background */¬†
        }
        .main-card {
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
        }
        input[type="number"]:focus, select:focus, textarea:focus {
            border-color: #14b8a6;¬†
            box-shadow: 0 0 0 3px rgba(20, 184, 166, 0.2);
            outline: none;
        }
        #analyze-button {
            background-image: linear-gradient(to right, #14b8a6, #0d9488); /* Teal gradient */
            transition: all 0.3s ease;
        }
        #analyze-button:hover {
            box-shadow: 0 10px 15px -3px rgba(20, 184, 166, 0.5);
            transform: translateY(-1px);
        }
        .share-button {
            background-image: linear-gradient(to right, #6366f1, #4f46e5); /* Indigo gradient */
            transition: all 0.3s ease;
        }
        .share-button:hover {
            box-shadow: 0 5px 10px -2px rgba(99, 102, 241, 0.4);
            transform: scale(1.02);
        }
        .recommendation {
            border-radius: 1rem;
            border-left-width: 0.5rem;
            padding: 1.5rem;
        }
        .hidden { display: none; }
    </style>
</head>
<body>

    <!-- ============================================== -->
    <!-- 1. LANDING PAGE VIEW (DARK MODE) -->
    <!-- ============================================== -->
    <div id="landing-page" class="landing-bg w-full">
        <div class="max-w-4xl mx-auto p-6 text-center">
            
            <div class="text-7xl mb-4">
                <span class="main-text-gradient">üß¨</span>
            </div>

            <h1 class="text-5xl md:text-7xl font-extrabold mb-4 leading-tight">
                <span class="main-text-gradient">AI</span> Health Score 
            </h1>
            
            <p class="text-xl md:text-2xl font-light mb-10 text-gray-400 max-w-2xl mx-auto">
                ‡πÄ‡∏õ‡∏¥‡∏î‡πÄ‡∏ú‡∏¢‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û‡∏ó‡∏µ‡πà‡∏ã‡πà‡∏≠‡∏ô‡∏≠‡∏¢‡∏π‡πà‡∏î‡πâ‡∏ß‡∏¢‡∏Å‡∏≤‡∏£‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡πÄ‡∏ä‡∏¥‡∏á‡∏•‡∏∂‡∏Å‡∏ó‡∏µ‡πà‡∏Ç‡∏±‡∏ö‡πÄ‡∏Ñ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡πÇ‡∏î‡∏¢ <span class="text-indigo-400 font-medium">‡πÄ‡∏ó‡∏Ñ‡πÇ‡∏ô‡πÇ‡∏•‡∏¢‡∏µ AI ‡∏≠‡∏±‡∏à‡∏â‡∏£‡∏¥‡∏¢‡∏∞</span>
            </p>

            <!-- CTA Button: Changes the view using JS -->
            <button onclick="showAnalysisPage()" class="cta-button inline-block px-12 py-5 text-xl font-bold text-white rounded-full shadow-lg">
                ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û‡∏ó‡∏±‡∏ô‡∏ó‡∏µ üöÄ
            </button>
            
            <p class="text-sm mt-8 text-gray-500">
                Powered by next-gen LLM Technology
            </p>
        </div>
    </div>

    <!-- ============================================== -->
    <!-- 2. ANALYSIS PAGE VIEW (LIGHT MODE) -->
    <!-- ============================================== -->
    <!-- ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç: ‡πÄ‡∏û‡∏¥‡πà‡∏° p-4 ‡∏ö‡∏ô‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠ ‡πÅ‡∏•‡∏∞ md:p-8 ‡∏ö‡∏ô‡πÄ‡∏î‡∏™‡∏Å‡πå‡∏ó‡πá‡∏≠‡∏õ ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡∏Ç‡∏≠‡∏ö‡∏à‡∏≠‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏™‡∏°‡∏ö‡∏π‡∏£‡∏ì‡πå -->
    <div id="analysis-page" class="hidden analysis-bg w-full min-h-screen flex items-start justify-center p-4 md:p-8">
        <div class="main-card max-w-4xl w-full bg-white p-6 md:p-10 rounded-2xl border border-teal-100 mt-4 mb-4">
            
            <!-- Header Section -->
            <h1 class="text-3xl md:text-4xl font-extrabold text-teal-700 text-center mb-6 pb-3">
                <span class="text-indigo-600">AI</span> Health Score üß¨
            </h1>
            
            <div class="membership-status p-4 mb-6 rounded-xl text-center font-bold text-lg bg-indigo-50 text-indigo-700 border border-indigo-300">
                üìä ‡∏õ‡∏•‡∏î‡∏•‡πá‡∏≠‡∏Å‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏±‡∏ß: ‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û‡πÄ‡∏ä‡∏¥‡∏á‡∏•‡∏∂‡∏Å‡πÅ‡∏•‡∏∞‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏ö‡∏∏‡∏Ñ‡∏Ñ‡∏•
            </div>

            <form onsubmit="analyzeHealth(event)" id="analysis-form" class="space-y-7">
                <h2 class="text-2xl font-bold text-gray-800 border-b-2 border-teal-200 pb-2 mb-4">1. ‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏£‡∏±‡∏ö‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô</h2>
                
                <!-- Input Grid Layout (‡πÉ‡∏ä‡πâ responsive classes: grid-cols-1, sm:grid-cols-2, lg:grid-cols-3) -->
                <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">
                    
                    <!-- ‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å -->
                    <div>
                        <label for="membership" class="block text-sm font-medium text-gray-700 mb-1">‚úÖ ‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å:</label>
                        <select id="membership" name="membership" class="w-full p-3 rounded-lg border">
                            <option value="free">FREE (‡∏ó‡∏î‡∏•‡∏≠‡∏á‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå)</option>
                            <option value="premium">PREMIUM (‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡πÄ‡∏ä‡∏¥‡∏á‡∏•‡∏∂‡∏Å)</option>
                        </select>
                    </div>
                    
                    <!-- ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Å‡πâ‡∏≤‡∏ß -->
                    <div>
                        <label for="steps" class="block text-sm font-medium text-gray-700 mb-1">üë£ ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Å‡πâ‡∏≤‡∏ß‡∏ï‡πà‡∏≠‡∏ß‡∏±‡∏ô (‡∏Å‡πâ‡∏≤‡∏ß):</label>
                        <input type="number" id="steps" name="steps" value="4500" required class="w-full p-3 rounded-lg border">
                    </div>

                    <!-- ‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á‡∏ô‡∏≠‡∏ô -->
                    <div>
                        <label for="sleep" class="block text-sm font-medium text-gray-700 mb-1">üåô ‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á‡∏ô‡∏≠‡∏ô‡∏ï‡πà‡∏≠‡∏ß‡∏±‡∏ô (‡∏ä‡∏°.):</label>
                        <input type="number" id="sleep" name="sleep" value="5.5" step="0.1" required class="w-full p-3 rounded-lg border">
                    </div>

                    <!-- ‡∏õ‡∏£‡∏¥‡∏°‡∏≤‡∏ì‡∏ô‡πâ‡∏≥‡∏î‡∏∑‡πà‡∏° -->
                    <div>
                        <label for="water" class="block text-sm font-medium text-gray-700 mb-1">üíß ‡∏õ‡∏£‡∏¥‡∏°‡∏≤‡∏ì‡∏ô‡πâ‡∏≥‡∏î‡∏∑‡πà‡∏°‡∏ï‡πà‡∏≠‡∏ß‡∏±‡∏ô (‡∏•‡∏¥‡∏ï‡∏£):</label>
                        <input type="number" id="water" name="water" value="1.2" step="0.1" required class="w-full p-3 rounded-lg border">
                    </div>
                    
                    <!-- ‡πÄ‡∏ß‡∏•‡∏≤‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏Å‡∏•‡∏≤‡∏á‡πÅ‡∏à‡πâ‡∏á -->
                    <div>
                        <label for="sun_exposure_mins" class="block text-sm font-medium text-gray-700 mb-1">‚òÄÔ∏è ‡πÄ‡∏ß‡∏•‡∏≤‡∏Å‡∏•‡∏≤‡∏á‡πÅ‡∏à‡πâ‡∏á‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡πÅ‡∏î‡∏î (‡∏ô‡∏≤‡∏ó‡∏µ/‡∏ß‡∏±‡∏ô):</label>
                        <input type="number" id="sun_exposure_mins" name="sun_exposure_mins" value="45" required class="w-full p-3 rounded-lg border">
                    </div>
                    
                    <!-- ‡∏ä‡πà‡∏≠‡∏á‡πÄ‡∏•‡∏∑‡∏≠‡∏Å Location -->
                    <div>
                        <label for="location" class="block text-sm font-medium text-gray-700 mb-1">üìç ‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå (‡∏à‡∏≥‡∏•‡∏≠‡∏á UV Index):</label>
                        <select id="location" name="location" class="w-full p-3 rounded-lg border">
                            <!-- Options generated by JS below -->
                        </select>
                    </div>
                </div>

                <div class="hint text-sm text-gray-500 p-4 bg-blue-50 border-l-4 border-blue-400 rounded-lg">
                    ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏∏‡∏Å‡∏™‡πà‡∏ß‡∏ô‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏ï‡πà‡∏≠‡∏Å‡∏≤‡∏£‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ AI ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÉ‡∏´‡πâ‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏ó‡∏µ‡πà‡πÅ‡∏°‡πà‡∏ô‡∏¢‡∏≥‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î
                </div>
                

                <button type="submit" id="analyze-button" class="w-full py-4 text-white font-bold rounded-xl shadow-lg transform">
                    ‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡πÅ‡∏•‡∏∞‡∏£‡∏±‡∏ö‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏±‡∏ß
                </button>
            </form>

            <!-- ‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå AI -->
            <div id="analysis-results" class="mt-10">
                <!-- AI analysis results will be injected here -->
            </div>
            
            <!-- ‡∏™‡πà‡∏ß‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÅ‡∏ä‡∏£‡πå‡∏•‡∏¥‡∏á‡∏Å‡πå (‡∏à‡∏∞‡∏õ‡∏£‡∏≤‡∏Å‡∏è‡∏´‡∏•‡∏±‡∏á‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡πÄ‡∏™‡∏£‡πá‡∏à) -->
            <div id="share-section" class="mt-10 hidden p-6 bg-indigo-50 rounded-xl border border-indigo-200">
                <h3 class="text-2xl font-bold text-indigo-700 mb-4 flex items-center">
                    ‚ú® ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÅ‡∏•‡πâ‡∏ß! ‡πÅ‡∏ä‡∏£‡πå‡πÉ‡∏´‡πâ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô!
                </h3>
                <p class="text-base text-gray-700 mb-4">
                    ‡∏ä‡∏ß‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡∏°‡∏≤‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û‡∏Ç‡∏≠‡∏á‡∏û‡∏ß‡∏Å‡πÄ‡∏Ç‡∏≤‡∏î‡πâ‡∏ß‡∏¢ AI ‡πÇ‡∏î‡∏¢‡∏Ñ‡∏•‡∏¥‡∏Å‡∏õ‡∏∏‡πà‡∏°‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏Ç‡∏≠‡∏á‡∏£‡∏∞‡∏ö‡∏ö‡πÑ‡∏õ‡∏¢‡∏±‡∏á‡∏Ñ‡∏•‡∏¥‡∏õ‡∏ö‡∏≠‡∏£‡πå‡∏î:
                </p>
                <div class="flex items-center space-x-3">
                    <button onclick="copyCurrentUrl()" class="share-button w-full py-3 text-white font-bold rounded-xl shadow-md flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.101l1.102-1.102m0 0a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1"></path></svg>
                        ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏•‡∏¥‡∏á‡∏Å‡πå‡πÅ‡∏≠‡∏õ‡∏û‡∏•‡∏¥‡πÄ‡∏Ñ‡∏ä‡∏±‡∏ô (Copy Link)
                    </button>
                </div>
                <div id="copy-feedback" class="text-green-600 font-medium mt-3 opacity-0 text-center">‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à‡πÅ‡∏•‡πâ‡∏ß!</div>
            </div>

        </div>
    </div>

    <script>
        // --- VIEW MANAGEMENT ---

        function showAnalysisPage() {
            document.getElementById('landing-page').classList.add('hidden');
            document.getElementById('analysis-page').classList.remove('hidden');
            // Change body background for visual switch from dark to light
            document.body.classList.remove('landing-bg');
            // ‡πÉ‡∏ä‡πâ Tailwind class ‡∏ó‡∏µ‡πà Analysis Page ‡∏Å‡∏≥‡∏´‡∏ô‡∏î background ‡πÅ‡∏ó‡∏ô
            document.body.classList.add('analysis-bg'); 
            // Scroll to top of the new view
            window.scrollTo(0, 0); 
        }

        // Initialize to show landing page first
        window.onload = function() {
            populateLocationDropdown();
            // Ensure analysis page is hidden on load
            document.getElementById('analysis-page').classList.add('hidden');
            document.body.classList.add('landing-bg'); // Set initial dark background
        }


        // --- HEALTH ANALYSIS LOGIC ---

        // ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≥‡∏•‡∏≠‡∏á UV Index ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå
        const uvLookup = {
            'bangkok_thailand': 9.5,
            'chiang_mai_thailand': 7.8,
            'london_uk': 2.5,
            'new_york_usa': 5.0,
            'tokyo_japan': 6.2
        };

        // ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏û‡∏±‡∏ô‡∏ò‡∏°‡∏¥‡∏ï‡∏£‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô (Critical: AI ‡∏ï‡πâ‡∏≠‡∏á‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏à‡∏≤‡∏Å Key ‡πÄ‡∏´‡∏•‡πà‡∏≤‡∏ô‡∏µ‡πâ)
        const affiliateProducts = {
            'DeepSleepFormula': { 
                name: 'üò¥ ‡∏ß‡∏¥‡∏ï‡∏≤‡∏°‡∏¥‡∏ô‡∏ä‡πà‡∏ß‡∏¢‡∏ô‡∏≠‡∏ô‡∏´‡∏•‡∏±‡∏ö‡∏™‡∏π‡∏ï‡∏£‡∏û‡∏£‡∏µ‡πÄ‡∏°‡∏µ‡∏¢‡∏°', 
                link: 'https://shoppy.co.th/product/high-commission-sleep-aid',
                description: '‡∏ä‡πà‡∏ß‡∏¢‡πÉ‡∏´‡πâ‡∏Ñ‡∏∏‡∏ì‡∏´‡∏•‡∏±‡∏ö‡πÑ‡∏î‡πâ‡∏•‡∏∂‡∏Å‡πÅ‡∏•‡∏∞‡∏°‡∏µ‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û‡∏°‡∏≤‡∏Å‡∏Ç‡∏∂‡πâ‡∏ô'
            },
            'HydratingSerum': { 
                name: '‚ú® ‡πÑ‡∏Æ‡∏¢‡∏≤‡∏•‡∏π‡∏£‡∏≠‡∏ô‡πÄ‡∏ã‡∏£‡∏±‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°‡∏ô‡πâ‡∏≥‡πÉ‡∏´‡πâ‡∏ú‡∏¥‡∏ß (‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ñ‡∏ô‡∏î‡∏∑‡πà‡∏°‡∏ô‡πâ‡∏≥‡∏ô‡πâ‡∏≠‡∏¢)', 
                link: 'https://shoppy.co.th/product/hyaluronic-acid-serum',
                description: '‡∏Å‡∏π‡πâ‡∏Ñ‡∏∑‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ä‡∏∏‡πà‡∏°‡∏ä‡∏∑‡πâ‡∏ô‡πÉ‡∏´‡πâ‡∏ú‡∏¥‡∏ß‡∏ó‡∏µ‡πà‡∏Ç‡∏≤‡∏î‡∏ô‡πâ‡∏≥‡∏à‡∏≤‡∏Å‡∏†‡∏≤‡∏¢‡πÉ‡∏ô'
            },
            'BroadSpectrumSunscreen': { 
                name: 'üõ°Ô∏è ‡∏Ñ‡∏£‡∏µ‡∏°‡∏Å‡∏±‡∏ô‡πÅ‡∏î‡∏î Broad Spectrum SPF50+', 
                link: 'https://shoppy.co.th/product/premium-uv-protector',
                description: '‡∏õ‡∏Å‡∏õ‡πâ‡∏≠‡∏á‡∏ú‡∏¥‡∏ß‡∏à‡∏≤‡∏Å‡∏£‡∏±‡∏á‡∏™‡∏µ UVA/UVB ‡∏ó‡∏µ‡πà‡∏£‡∏∏‡∏ô‡πÅ‡∏£‡∏á‡πÉ‡∏ô‡πÄ‡∏Ç‡∏ï‡∏£‡πâ‡∏≠‡∏ô'
            },
            'HighProteinBar': { 
                name: 'üí™ ‡πÇ‡∏õ‡∏£‡∏ï‡∏µ‡∏ô‡∏ö‡∏≤‡∏£‡πå‡∏£‡∏™‡∏ä‡πá‡∏≠‡∏Å‡πÇ‡∏Å‡πÅ‡∏•‡∏ï (‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ñ‡∏ô‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏û‡∏•‡∏±‡∏á‡∏á‡∏≤‡∏ô/‡πÄ‡∏î‡∏¥‡∏ô‡∏ô‡πâ‡∏≠‡∏¢)', 
                link: 'https://shoppy.co.th/product/protein-snack-bar',
                description: '‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏û‡∏•‡∏±‡∏á‡∏á‡∏≤‡∏ô‡πÅ‡∏•‡∏∞‡πÇ‡∏õ‡∏£‡∏ï‡∏µ‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ã‡πà‡∏≠‡∏°‡πÅ‡∏ã‡∏°‡πÅ‡∏•‡∏∞‡πÄ‡∏™‡∏£‡∏¥‡∏°‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Å‡∏•‡πâ‡∏≤‡∏°‡πÄ‡∏ô‡∏∑‡πâ‡∏≠'
            },
            'VitaminDSupplements': {
                name: 'üíä ‡∏ß‡∏¥‡∏ï‡∏≤‡∏°‡∏¥‡∏ô D3 K2 ‡∏î‡∏π‡∏î‡∏ã‡∏∂‡∏°‡∏™‡∏π‡∏á (‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ú‡∏π‡πâ‡∏´‡∏•‡∏µ‡∏Å‡πÄ‡∏•‡∏µ‡πà‡∏¢‡∏á‡πÅ‡∏î‡∏î)',
                link: 'https://shoppy.co.th/product/vitamin-d-k2-high-absorption',
                description: '‡πÄ‡∏™‡∏£‡∏¥‡∏°‡∏ß‡∏¥‡∏ï‡∏≤‡∏°‡∏¥‡∏ô D ‡∏ó‡∏µ‡πà‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô‡πÇ‡∏î‡∏¢‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏ú‡∏ä‡∏¥‡∏ç‡∏Å‡∏±‡∏ö‡πÅ‡∏™‡∏á‡πÅ‡∏î‡∏î‡πÅ‡∏£‡∏á‡πÜ'
            }
        };


        function populateLocationDropdown() {
            const select = document.getElementById('location');
            select.innerHTML = ''; 
            
            for (const [code, uv_value] of Object.entries(uvLookup)) {
                const option = document.createElement('option');
                option.value = code;
                const displayCode = code.split('_').map(w => w.charAt(0).toUpperCase() + w.slice(1)).join(' / ');
                option.textContent = `${displayCode} (Simulated UV: ${uv_value.toFixed(1)})`;
                select.appendChild(option);
            }
        }
        
        function copyCurrentUrl() {
            try {
                const url = window.location.href;
                const tempInput = document.createElement('textarea');
                tempInput.value = url;
                document.body.appendChild(tempInput);
                tempInput.select();
                document.execCommand('copy');
                document.body.removeChild(tempInput);
                
                // Show feedback message
                const feedback = document.getElementById('copy-feedback');
                feedback.textContent = '‚úÖ ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à! ‡πÅ‡∏ä‡∏£‡πå‡πÉ‡∏´‡πâ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢‡∏Ñ‡πà‡∏∞';
                feedback.classList.remove('opacity-0');
                feedback.classList.add('opacity-100');
                
                setTimeout(() => {
                    feedback.classList.remove('opacity-100');
                    feedback.classList.add('opacity-0');
                }, 3000);

            } catch (err) {
                console.error('Could not copy link:', err);
                const feedback = document.getElementById('copy-feedback');
                feedback.textContent = '‚ùå ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏•‡∏¥‡∏á‡∏Å‡πå‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏î‡πâ‡∏ß‡∏¢‡∏ï‡∏ô‡πÄ‡∏≠‡∏á';
                feedback.classList.remove('opacity-0');
                feedback.classList.add('opacity-100');
            }
        }

        // --- MOCK DATA FOR SIMULATION (‡πÅ‡∏ó‡∏ô‡∏ó‡∏µ‡πà‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏à‡∏≤‡∏Å AI) ---
        // ‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ô‡∏µ‡πâ‡πÉ‡∏ä‡πâ product_id ‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡πÑ‡∏ß‡πâ‡πÉ‡∏ô affiliateProducts ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô
        const mockResultsJson = [
            {
                "title": "‡∏Å‡∏≤‡∏£‡∏ô‡∏≠‡∏ô‡∏´‡∏•‡∏±‡∏ö‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏û‡∏±‡∏Å‡∏ú‡πà‡∏≠‡∏ô üåô",
                "analysis_summary": "‡∏î‡πâ‡∏ß‡∏¢‡πÄ‡∏ß‡∏•‡∏≤‡∏Å‡∏≤‡∏£‡∏ô‡∏≠‡∏ô‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢ 5.5 ‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á‡∏ï‡πà‡∏≠‡∏ß‡∏±‡∏ô ‡∏ã‡∏∂‡πà‡∏á‡∏ï‡πà‡∏≥‡∏Å‡∏ß‡πà‡∏≤‡πÄ‡∏Å‡∏ì‡∏ë‡πå‡∏ó‡∏µ‡πà‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥ (7-9 ‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á) ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏°‡∏µ‡∏ô‡∏±‡∏¢‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç ‡∏™‡πà‡∏á‡∏ú‡∏•‡πÉ‡∏´‡πâ‡∏£‡πà‡∏≤‡∏á‡∏Å‡∏≤‡∏¢‡∏≠‡∏≤‡∏à‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏ü‡∏∑‡πâ‡∏ô‡∏ü‡∏π‡πÑ‡∏î‡πâ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÄ‡∏ï‡πá‡∏°‡∏ó‡∏µ‡πà ‡∏Å‡∏≤‡∏£‡∏Ç‡∏≤‡∏î‡∏Å‡∏≤‡∏£‡∏ô‡∏≠‡∏ô‡∏´‡∏•‡∏±‡∏ö‡∏™‡πà‡∏á‡∏ú‡∏•‡∏Å‡∏£‡∏∞‡∏ó‡∏ö‡πÇ‡∏î‡∏¢‡∏ï‡∏£‡∏á‡∏ï‡πà‡∏≠‡∏Æ‡∏≠‡∏£‡πå‡πÇ‡∏°‡∏ô ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏Ñ‡∏£‡∏µ‡∏¢‡∏î ‡πÅ‡∏•‡∏∞‡∏Ñ‡∏ß‡∏≤‡∏°‡∏≠‡∏¢‡∏≤‡∏Å‡∏≠‡∏≤‡∏´‡∏≤‡∏£ ‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏õ‡∏£‡∏∞‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡∏†‡∏≤‡∏û‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏ä‡∏µ‡∏ß‡∏¥‡∏ï‡πÉ‡∏ô‡∏ß‡∏±‡∏ô‡∏£‡∏∏‡πà‡∏á‡∏Ç‡∏∂‡πâ‡∏ô‡∏•‡∏î‡∏•‡∏á‡∏°‡∏≤‡∏Å",
                "product_id": "DeepSleepFormula" // Key ‡∏ô‡∏µ‡πâ‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö affiliateProducts
            },
            {
                "title": "‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏°‡∏î‡∏∏‡∏•‡∏Ç‡∏≠‡∏á‡∏ô‡πâ‡∏≥‡πÅ‡∏•‡∏∞‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏° üíß",
                "analysis_summary": "‡∏õ‡∏£‡∏¥‡∏°‡∏≤‡∏ì‡∏ô‡πâ‡∏≥‡∏î‡∏∑‡πà‡∏° 1.2 ‡∏•‡∏¥‡∏ï‡∏£ ‡∏ñ‡∏∑‡∏≠‡∏ß‡πà‡∏≤‡∏ô‡πâ‡∏≠‡∏¢‡∏Å‡∏ß‡πà‡∏≤‡∏õ‡∏£‡∏¥‡∏°‡∏≤‡∏ì‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡πà‡∏≥‡∏ó‡∏µ‡πà‡∏£‡πà‡∏≤‡∏á‡∏Å‡∏≤‡∏¢‡∏Ñ‡∏ß‡∏£‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö (‡πÇ‡∏î‡∏¢‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢ 2.5 ‡∏•‡∏¥‡∏ï‡∏£) ‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏ú‡∏¥‡∏ß‡∏Ç‡∏≤‡∏î‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ä‡∏∏‡πà‡∏°‡∏ä‡∏∑‡πâ‡∏ô‡πÅ‡∏•‡∏∞‡∏Å‡∏£‡∏∞‡∏ö‡∏ß‡∏ô‡∏Å‡∏≤‡∏£‡∏Ç‡∏±‡∏ö‡∏Ç‡∏≠‡∏á‡πÄ‡∏™‡∏µ‡∏¢‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÑ‡∏î‡πâ‡πÑ‡∏°‡πà‡πÄ‡∏ï‡πá‡∏°‡∏ó‡∏µ‡πà ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏£‡∏ß‡∏°‡∏Å‡∏±‡∏ö‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Å‡πâ‡∏≤‡∏ß‡∏ï‡πà‡∏≠‡∏ß‡∏±‡∏ô 4,500 ‡∏Å‡πâ‡∏≤‡∏ß (‡∏ã‡∏∂‡πà‡∏á‡∏ï‡πà‡∏≥‡∏Å‡∏ß‡πà‡∏≤‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢ 10,000 ‡∏Å‡πâ‡∏≤‡∏ß) ‡∏≠‡∏≤‡∏à‡∏™‡πà‡∏á‡∏ú‡∏•‡πÉ‡∏´‡πâ‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏ú‡∏≤‡∏ú‡∏•‡∏≤‡∏ç‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÑ‡∏î‡πâ‡∏ä‡πâ‡∏≤‡∏•‡∏á ‡∏Ñ‡∏ß‡∏£‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Å‡∏≤‡∏£‡∏î‡∏∑‡πà‡∏°‡∏ô‡πâ‡∏≥‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡πÄ‡∏Ñ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏´‡∏ß‡πÉ‡∏´‡πâ‡∏°‡∏≤‡∏Å‡∏Ç‡∏∂‡πâ‡∏ô",
                "product_id": "HydratingSerum" // Key ‡∏ô‡∏µ‡πâ‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö affiliateProducts
            },
            {
                "title": "‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á UV ‡πÅ‡∏•‡∏∞‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏ß‡∏¥‡∏ï‡∏≤‡∏°‡∏¥‡∏ô D ‚òÄÔ∏è (Premium Insight)",
                "analysis_summary": "‡∏Å‡∏≤‡∏£‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡πÅ‡∏™‡∏á‡πÅ‡∏î‡∏î 45 ‡∏ô‡∏≤‡∏ó‡∏µ‡∏ï‡πà‡∏≠‡∏ß‡∏±‡∏ô‡πÉ‡∏ô‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏Ñ‡πà‡∏≤ UV Index ‡∏™‡∏π‡∏á (‡πÄ‡∏ä‡πà‡∏ô ‡∏Å‡∏£‡∏∏‡∏á‡πÄ‡∏ó‡∏û‡∏Ø: 9.5) ‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡∏ï‡πà‡∏≠‡∏Å‡∏≤‡∏£‡∏ñ‡∏π‡∏Å‡∏ó‡∏≥‡∏•‡∏≤‡∏¢‡∏Ç‡∏≠‡∏á‡πÄ‡∏ã‡∏•‡∏•‡πå‡∏ú‡∏¥‡∏ß‡∏´‡∏ô‡∏±‡∏á‡∏à‡∏≤‡∏Å‡∏£‡∏±‡∏á‡∏™‡∏µ UV ‡∏™‡∏π‡∏á‡∏°‡∏≤‡∏Å ‡πÅ‡∏°‡πâ‡∏à‡∏∞‡∏ä‡πà‡∏ß‡∏¢‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡∏±‡∏á‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏ß‡∏¥‡∏ï‡∏≤‡∏°‡∏¥‡∏ô D ‡πÅ‡∏ï‡πà‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏≠‡∏á‡πÅ‡∏ô‡πà‡πÉ‡∏à‡∏ß‡πà‡∏≤‡πÑ‡∏î‡πâ‡πÉ‡∏ä‡πâ‡∏°‡∏≤‡∏ï‡∏£‡∏Å‡∏≤‡∏£‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡πÅ‡∏™‡∏á‡πÅ‡∏î‡∏î‡∏ó‡∏µ‡πà‡πÄ‡∏û‡∏µ‡∏¢‡∏á‡∏û‡∏≠ ‡πÄ‡∏ä‡πà‡∏ô ‡∏Ñ‡∏£‡∏µ‡∏°‡∏Å‡∏±‡∏ô‡πÅ‡∏î‡∏î‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏õ‡∏£‡∏∞‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡∏†‡∏≤‡∏û‡πÅ‡∏•‡∏∞‡∏™‡∏ß‡∏°‡πÉ‡∏™‡πà‡πÄ‡∏™‡∏∑‡πâ‡∏≠‡∏ú‡πâ‡∏≤‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡πÄ‡∏õ‡πá‡∏ô‡∏õ‡∏£‡∏∞‡∏à‡∏≥",
                "product_id": "BroadSpectrumSunscreen" // Key ‡∏ô‡∏µ‡πâ‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö affiliateProducts
            }
        ];
        
        /**
         * üí° ‡πÅ‡∏ô‡∏ß‡∏ó‡∏≤‡∏á‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö‡πÉ‡∏´‡πâ AI ‡πÉ‡∏ä‡πâ‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏ú‡∏•‡∏¥‡∏ï‡∏†‡∏±‡∏ì‡∏ë‡πå‡∏û‡∏±‡∏ô‡∏ò‡∏°‡∏¥‡∏ï‡∏£‡∏Ç‡∏≠‡∏á‡πÄ‡∏£‡∏≤ (‡∏´‡∏≤‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡πÉ‡∏ä‡πâ Gemini API ‡∏à‡∏£‡∏¥‡∏á)
         * * ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏Ñ‡∏∏‡∏ì‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡πÉ‡∏ä‡πâ Gemini API ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå ‡∏Ñ‡∏∏‡∏ì‡∏à‡∏∞‡∏ï‡πâ‡∏≠‡∏á‡∏™‡πà‡∏á Response Schema ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á JSON 
         * ‡∏ó‡∏µ‡πà AI ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ç‡∏∂‡πâ‡∏ô ‡πÇ‡∏î‡∏¢‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏¢‡∏¥‡πà‡∏á‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ 'enum' ‡πÉ‡∏ô property 'product_id'
         * * 1. ‡∏™‡∏£‡πâ‡∏≤‡∏á Schema ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á JSON ‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£:
         * const productKeys = Object.keys(affiliateProducts);
         * const LLM_RESPONSE_SCHEMA = {
         * type: "ARRAY",
         * items: {
         * type: "OBJECT",
         * properties: {
         * "title": { "type": "STRING" },
         * "analysis_summary": { "type": "STRING" },
         * // ‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö‡πÉ‡∏´‡πâ AI ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å product_id ‡∏à‡∏≤‡∏Å‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£ Key ‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏≤‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡πÑ‡∏ß‡πâ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô
         * "product_id": { 
         * "type": "STRING", 
         * "enum": productKeys 
         * }
         * }
         * }
         * };
         * * 2. ‡∏™‡πà‡∏á Schema ‡∏ô‡∏µ‡πâ‡πÑ‡∏õ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏Å‡∏±‡∏ö API Call ‡πÉ‡∏ô‡∏™‡πà‡∏ß‡∏ô 'generationConfig':
         * const payload = {
         * contents: [...], // ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û‡∏ó‡∏µ‡πà‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏Å‡∏£‡∏≠‡∏Å
         * generationConfig: {
         * responseMimeType: "application/json",
         * responseSchema: LLM_RESPONSE_SCHEMA
         * },
         * systemInstruction: {
         * parts: [{ text: "‡∏Ñ‡∏∏‡∏ì‡∏Ñ‡∏∑‡∏≠‡∏ú‡∏π‡πâ‡πÄ‡∏ä‡∏µ‡πà‡∏¢‡∏ß‡∏ä‡∏≤‡∏ç‡∏î‡πâ‡∏≤‡∏ô‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û‡∏ó‡∏µ‡πà‡∏ó‡∏≥‡∏Å‡∏≤‡∏£‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡πÅ‡∏•‡∏∞‡πÉ‡∏´‡πâ‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏ú‡∏•‡∏¥‡∏ï‡∏†‡∏±‡∏ì‡∏ë‡πå‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡πâ‡∏≠‡∏á ‡πÇ‡∏î‡∏¢‡∏ï‡πâ‡∏≠‡∏á‡πÉ‡∏ä‡πâ‡∏£‡∏´‡∏±‡∏™‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ (product_id) ‡∏ó‡∏µ‡πà‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡πÑ‡∏ß‡πâ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô" }]
         * }
         * };
         * * ‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡πÄ‡∏ä‡πà‡∏ô‡∏ô‡∏µ‡πâ‡∏à‡∏∞‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∞‡∏Å‡∏±‡∏ô‡∏ß‡πà‡∏≤ product_id ‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏Å‡∏•‡∏±‡∏ö‡∏°‡∏≤‡∏à‡∏∞‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏≤‡∏Ç‡∏≤‡∏¢‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô
         */

        // Function to handle the form submission and data display (Now using Mock Data)
        async function analyzeHealth(event) {
            event.preventDefault();

            const form = event.target;
            const membership = form.membership.value;

            const resultsDiv = document.getElementById('analysis-results');
            const analyzeButton = document.getElementById('analyze-button');
            const shareSection = document.getElementById('share-section');

            resultsDiv.innerHTML = ''; 
            shareSection.classList.add('hidden');
            
            // --- Set Loading State ---
            analyzeButton.disabled = true;
            analyzeButton.innerHTML = '<span class="animate-pulse">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏õ‡∏£‡∏∞‡∏°‡∏ß‡∏•‡∏ú‡∏•‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡πÄ‡∏ä‡∏¥‡∏á‡∏•‡∏∂‡∏Å‡∏à‡∏≤‡∏Å AI... üìä</span>';
            
            // --- SIMULATION (MOCK API Call) ---
            // Simulate a network delay of 2 seconds for a realistic user experience
            await new Promise(r => setTimeout(r, 2000)); 
            
            // ‡πÉ‡∏ä‡πâ mock data ‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏•‡πá‡∏≠‡∏Å‡πÑ‡∏ß‡πâ‡πÉ‡∏´‡πâ‡πÉ‡∏ä‡πâ Key ‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏Ç‡∏≠‡∏á‡πÄ‡∏£‡∏≤‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô
            const resultsJson = mockResultsJson;
            
            // --- Reset Button State ---
            analyzeButton.disabled = false;
            analyzeButton.textContent = '‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡πÅ‡∏•‡∏∞‡∏£‡∏±‡∏ö‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏±‡∏ß';
            
            // --- Display Results ---
            if (resultsJson && Array.isArray(resultsJson)) {
                let htmlContent = `
                    <div class="result-box mt-10 space-y-8">
                        <h2 class="text-3xl font-bold text-teal-700 border-b-2 border-indigo-200 pb-3">
                            üî¨ ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå AI 
                        </h2>
                `;
                
                resultsJson.forEach(item => {
                    // ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏•‡∏¥‡∏ï‡∏†‡∏±‡∏ì‡∏ë‡πå‡∏û‡∏±‡∏ô‡∏ò‡∏°‡∏¥‡∏ï‡∏£‡∏à‡∏≤‡∏Å product_id ‡∏ó‡∏µ‡πà AI (‡∏´‡∏£‡∏∑‡∏≠ Mock Data) ‡∏™‡πà‡∏á‡∏°‡∏≤
                    const product = affiliateProducts[item.product_id];
                    
                    // ‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏ñ‡πâ‡∏≤ AI ‡∏™‡πà‡∏á product_id ‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡∏£‡∏π‡πâ‡∏à‡∏±‡∏Å‡∏°‡∏≤ (‡πÅ‡∏°‡πâ‡∏ß‡πà‡∏≤ Schema ‡∏à‡∏∞‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡πÅ‡∏•‡πâ‡∏ß)
                    if (!product) {
                        console.error("Critical: AI recommended an unknown product_id:", item.product_id);
                        return;
                    }

                    const isPremiumFeature = item.title.includes('UV'); 
                    const isLocked = isPremiumFeature && membership !== 'premium';
                    
                    htmlContent += `
                        <div class="recommendation 
                            ${isPremiumFeature ? 'border-amber-600 bg-amber-50' : 'border-teal-500 bg-white'}">
                            
                            <h3 class="text-xl font-bold text-gray-800 flex items-center justify-between mb-3">
                                <span>${item.title}</span>
                                <span class="text-xs font-semibold px-3 py-1 rounded-full 
                                    ${isPremiumFeature ? 'bg-amber-200 text-amber-800' : 'bg-teal-100 text-teal-800'}">
                                    ${isPremiumFeature ? 'PREMIUM INSIGHT' : 'CORE INSIGHT'}
                                </span>
                            </h3>
                            
                            <p class="text-gray-600 mt-2">${item.analysis_summary}</p>
                            
                            <!-- Affiliate Link Section -->
                            <div class="mt-4 pt-4 border-t border-gray-200">
                                ${isLocked ? `
                                    <div class="p-3 bg-gray-200 text-gray-700 border border-dashed border-gray-400 rounded-lg italic text-sm text-center font-medium">
                                        üîê ‡∏õ‡∏•‡∏î‡∏•‡πá‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏ä‡∏¥‡∏á‡∏•‡∏∂‡∏Å UV Advanced Report ‡πÇ‡∏î‡∏¢‡πÄ‡∏õ‡πá‡∏ô‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å Premium
                                    </div>
                                ` : `
                                    <p class="text-sm font-medium text-gray-700 mb-2">
                                        üöÄ **‡∏ó‡∏≤‡∏á‡∏≠‡∏≠‡∏Å‡∏ó‡∏µ‡πà‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥ (‡∏ú‡∏•‡∏¥‡∏ï‡∏†‡∏±‡∏ì‡∏ë‡πå‡∏û‡∏±‡∏ô‡∏ò‡∏°‡∏¥‡∏ï‡∏£):** <span class="text-orange-600 font-bold">${product.name}</span>
                                    </p>
                                    <a href="${product.link}" target="_blank" class="inline-block px-5 py-2 text-sm font-semibold text-white rounded-lg shadow-md bg-orange-500 hover:bg-orange-600 transition duration-300">
                                        üõí ‡∏î‡∏π‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡πÅ‡∏•‡∏∞‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠ (Affiliate Link)
                                    </a>
                                `}
                            </div>
                        </div>
                    `;
                });

                htmlContent += `
                    </div>
                    <div class="mt-10 p-4 rounded-lg bg-red-50 text-red-700 border-l-4 border-red-500 text-sm font-medium">
                        **‡∏Ç‡πâ‡∏≠‡∏™‡∏á‡∏ß‡∏ô‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå:** ‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏ô‡∏µ‡πâ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÇ‡∏î‡∏¢‡πÄ‡∏ó‡∏Ñ‡πÇ‡∏ô‡πÇ‡∏•‡∏¢‡∏µ AI ‡∏≠‡∏±‡∏à‡∏â‡∏£‡∏¥‡∏¢‡∏∞ ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏õ‡∏£‡∏∞‡∏™‡∏á‡∏Ñ‡πå‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡πâ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏ö‡∏∑‡πâ‡∏≠‡∏á‡∏ï‡πâ‡∏ô‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô ‡πÅ‡∏•‡∏∞‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÉ‡∏ä‡πâ‡πÅ‡∏ó‡∏ô‡∏Å‡∏≤‡∏£‡∏ß‡∏¥‡∏ô‡∏¥‡∏à‡∏â‡∏±‡∏¢‡∏ó‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡πÅ‡∏û‡∏ó‡∏¢‡πå‡πÑ‡∏î‡πâ ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏õ‡∏£‡∏∂‡∏Å‡∏©‡∏≤‡πÅ‡∏û‡∏ó‡∏¢‡πå‡∏´‡∏≤‡∏Å‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏Å‡∏±‡∏á‡∏ß‡∏•‡∏î‡πâ‡∏≤‡∏ô‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û
                    </div>
                `;

                resultsDiv.innerHTML = htmlContent;
                
                // --- Show Sharing Section ---
                shareSection.classList.remove('hidden');

            } else {
                resultsDiv.innerHTML = `
                    <p class="text-red-600 text-center mt-8 p-4 bg-red-50 border border-red-300 rounded-lg">
                        ‚ö†Ô∏è ‡∏Ç‡∏≠‡∏≠‡∏†‡∏±‡∏¢! ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏õ‡∏£‡∏∞‡∏°‡∏ß‡∏•‡∏ú‡∏•‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏à‡∏≤‡∏Å AI ‡πÑ‡∏î‡πâ (‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏à‡∏≥‡∏•‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•).
                    </p>
                `;
            }
        }
    </script>
</body>
</html>
